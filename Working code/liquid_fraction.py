import numpy as np
import matplotlib.pyplot as plt
import scipy.ndimage as nd

path_name = "/Users/Jesper/Documents/MEP/Code/Working code/sim_data/Tlin/octadecane/Ra108/"

# fL100 = np.genfromtxt(path_name+"N100/fL_Ra1.e+08_Pr50.0_Ste0.1_tau0.55_N=100x100_t=11565.0.csv", delimiter=',')
# fL140 = np.genfromtxt(path_name+"N140/fL_Ra1.e+08_Pr50.0_Ste0.1_tau0.55_N=140x140_t=11565.0.csv", delimiter=',')
# fL196 = np.genfromtxt(path_name+"N196/fL_Ra1.e+08_Pr50.0_Ste0.1_tau0.55_N=196x196_t=11565.0.csv", delimiter=',')
# fL240 = np.genfromtxt(path_name+"N240/fL_Ra1.e+08_Pr50.0_Ste0.1_tau0.55_N=240x240_t=11565.0.csv", delimiter=',')
# fL_mean100 = np.mean(fL100)
# fL_mean140 = np.mean(fL140)
# fL_mean196 = np.mean(fL196)
# fL_mean240 = np.mean(fL240)
# print(fL_mean100)
# print(fL_mean140)
# print(fL_mean196)
# print(fL_mean240)
# fL = np.array([fL_mean100, fL_mean140, fL_mean196, fL_mean240])
# N = np.array([100, 140, 196, 240])
#
# plt.figure()
# plt.plot(N, fL, '-o', color="#029386", mfc='k', mec='k', markersize=5)
# plt.xlabel(r'$N$', fontsize=14)
# plt.ylabel(r'$f_L$', fontsize=14)
# plt.grid(alpha=0.3)
# # plt.ylim(0, 70)
# plt.savefig("/Users/Jesper/Documents/MEP/Code/Working code/Figures/Hsou/" + "grid_indepence.png", dpi=300)

fL_mencinger = np.array([[0.06371191135734071, 0],
                        [0.07017543859649124, 0.012927054478300892],
                        [0.08033240997229917, 0.024007386888273308],
                        [0.09418282548476452, 0.0424746075715603],
                        [0.11172668513388735, 0.06832871652816241],
                        [0.1311172668513389, 0.10156971375807933],
                        [0.1394275161588181, 0.11357340720221587],
                        [0.14681440443213295, 0.12927054478301014],
                        [0.1523545706371191, 0.14589104339796843],
                        [0.15604801477377656, 0.16435826408125565],
                        [0.16251154201292706, 0.18651892890120025],
                        [0.17082179132040626, 0.20683287165281616],
                        [0.18005540166204986, 0.23453370267774698],
                        [0.19205909510618657, 0.2807017543859649],
                        [0.19944598337950142, 0.3028624192059094],
                        [0.20775623268698062, 0.3268698060941828],
                        [0.21421975992613107, 0.350877192982456],
                        [0.22253000923361033, 0.3693444136657432],
                        [0.23453370267774698, 0.39889196675900274],
                        [0.24192059095106183, 0.42289935364727604],
                        [0.24930747922437674, 0.45244690674053545],
                        [0.26408125577100644, 0.48938134810710987],
                        [0.27331486611265005, 0.5170821791320406],
                        [0.2862419205909511, 0.5466297322253],
                        [0.2991689750692521, 0.5780240073868883],
                        [0.31024930747922436, 0.6020313942751615],
                        [0.329639889196676, 0.6371191135734071],
                        [0.34349030470914127, 0.6648199445983379],
                        [0.3591874422899353, 0.6888273314866112],
                        [0.3776546629732225, 0.7072945521698983],
                        [0.3905817174515235, 0.7183748845798708],
                        [0.4108956602031394, 0.7340720221606647],
                        [0.4293628808864266, 0.7442289935364728],
                        [0.4515235457063712, 0.755309325946445],
                        [0.48753462603878117, 0.7700831024930748],
                        [0.5244690674053555, 0.7830101569713759],
                        [0.5493998153277931, 0.7903970452446907],
                        [0.5863342566943675, 0.8060941828254847],
                        [0.615881809787627, 0.8162511542012927],
                        [0.6546629732225301, 0.8356417359187442],
                        [0.6805170821791321, 0.8494921514312096],
                        [0.7026777469990766, 0.8624192059095106],
                        [0.7202216066481996, 0.8734995383194829],
                        [0.7414589104339796, 0.8882733148661126],
                        [0.7562326869806092, 0.8993536472760849],
                        [0.7710064635272391, 0.9104339796860572],
                        [0.7867036011080333, 0.9224376731301939],
                        [0.8014773776546629, 0.9381348107109879],
                        [0.8153277931671283, 0.9492151431209602],
                        [0.8291782086795937, 0.9621421975992613],
                        [0.8411819021237305, 0.9778393351800554],
                        [0.8513388734995383, 0.9916897506925207],
                        [0.8513388734995383, 0.9990766389658357]])

fL_fuentes = np.array([[0.08215767634854773, 0.011550076617138028],
                    [0.10373443983402489, 0.028129680962793224],
                    [0.12199170124481327, 0.05052116871265988],
                    [0.14439834024896267, 0.08535734577572696],
                    [0.16182572614107882, 0.11355865084967542],
                    [0.1767634854771784, 0.15504003030250846],
                    [0.19336099585062236, 0.19154077925655522],
                    [0.20663900414937758, 0.2263845319467639],
                    [0.22406639004149378, 0.27616260050618957],
                    [0.23734439834024895, 0.3126661042337424],
                    [0.2580912863070539, 0.3690804221690397],
                    [0.27800829875518673, 0.4205161756856802],
                    [0.3004149377593361, 0.47194986312219134],
                    [0.32033195020746885, 0.511767359377421],
                    [0.35020746887966814, 0.5681741016855769],
                    [0.38008298755186737, 0.6113028356949776],
                    [0.4074688796680499, 0.6519440092284912],
                    [0.4464730290456433, 0.7041937983161446],
                    [0.48464730290456437, 0.7506351474664692],
                    [0.520331950207469, 0.7871200564728568],
                    [0.5593360995850623, 0.8252619617430828],
                    [0.5775933609958507, 0.8418443208622439],
                    [0.5925311203319502, 0.8509605550868613],
                    [0.6058091286307054, 0.8550989135861984],
                    [0.6547717842323653, 0.8724856665691016],
                    [0.7195020746887967, 0.8923489609338681],
                    [0.7692946058091287, 0.9080752741860504],
                    [0.8174273858921163, 0.9271224668996745],
                    [0.8522821576763485, 0.9436910521513058],
                    [0.8697095435684649, 0.9569545978891547],
                    [0.8821576763485478, 0.9693924002685903],
                    [0.8871369294605809, 0.9793467743323977],
                    [0.8879668049792531, 0.9926240939377764]])

fL_octa_hlin = np.genfromtxt(path_name+"N240/fL_Ra1.e+08_Pr50.0_Ste0.1_tau0.55_N=240x240_t=11565.0.csv", delimiter=',')
fL_octa_hsou = np.genfromtxt("/Users/Jesper/Documents/MEP/Code/Working code/sim_data/Hsou/octadecane/Ra108/N240/fL_Ra1.e+08_Pr50.0_Ste0.1_tau0.55_N=240x240_t=11565.0.csv", delimiter=',')

Nx = 240
Ny = Nx
x_fL_hlin = np.zeros((Nx, 1))
y_fL_hlin = (np.linspace(0, Ny, Ny) + 0.5) / Ny

for j in range(Ny):
    half_fL = np.abs(fL_octa_hlin[j, :] - 0.5)
    idx = half_fL.argmin()
    x_fL_hlin[j] = (idx + 0.5) / Nx

x_fL_hsou = np.zeros((Nx, 1))
y_fL_hsou = (np.linspace(0, Ny, Ny) + 0.5) / Ny

for j in range(Ny):
    half_fL = np.abs(fL_octa_hsou[j, :] - 0.5)
    idx = half_fL.argmin()
    x_fL_hsou[j] = (idx + 0.5) / Nx

fig, ax = plt.subplots()
ax.plot(fL_mencinger[:, 0], fL_mencinger[:, 1], color="k", linestyle=':', label="Mencinger")
ax.plot(fL_fuentes[:, 0], fL_fuentes[:, 1], color="k", linestyle='--', label="Fuentes")
ax.plot(nd.gaussian_filter(x_fL_hlin, 2), y_fL_hlin, color="#2c6fbb", label="H-Linear")
ax.plot(nd.gaussian_filter(x_fL_hsou, 2), y_fL_hsou, color="#8c000f", label="H-Source")
ax.legend([r"Mencinger", r"Fuentes", r"H-Linear", r"H-Source"])
ax.set_xlabel(r'$\bar{x}$', fontsize=14)
ax.set_ylabel(r'$\bar{y}$', fontsize=14)
plt.grid(alpha=0.3)
plt.xlim(0, 1)
plt.ylim(0, 1)
plt.savefig("/Users/Jesper/Documents/MEP/Code/Working code/Figures/Hsou/fL_comp_octa.png", dpi=300)
