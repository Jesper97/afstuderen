import numpy as np
import matplotlib.pyplot as plt
from scipy.interpolate import make_interp_spline, BSpline

path_name = "/Users/Jesper/Documents/MEP/Code/Working code/Figures/Tlin/octadecane/Ra108/Nusselt_test/"

Ra = 1e8
L = 0.1
Nx = 140
Ny = Nx

# fL = np.genfromtxt('/Users/Jesper/Documents/MEP/Code/Working code/sim_data/Tlin/octadecane/Ra108/N140/fL_Ra1.e+08_Pr50.0_Ste0.1_tau0.55_N=140x140.png.csv', delimiter=',')
#
# half_fL = np.abs(fL - 0.5)
# idx = half_fL.argmin(axis=1)
# x_front = (idx + 0.5) / Nx * L
# x_front = x_front[0:-1:2]
# y_front = (np.linspace(0.5, Nx + 1, x_front.shape[0])) / Ny * L
#
# y_front_new = np.linspace(y_front.min(), y_front.max(), 600)
# spl = make_interp_spline(y_front, x_front, k=3)
# x_front_smooth = spl(y_front_new)

mencinger = np.array([[0.042114496768236385, 0.010526315789473495],
                      [0.05791166512773161, 0.019298245614034926],
                      [0.08688288704216682, 0.04649122807017525],
                      [0.11937980917205296, 0.09298245614035083],
                      [0.14047706986765154, 0.1438596491228068],
                      [0.15630963373345644, 0.1929824561403507],
                      [0.1783025546321945, 0.2649122807017542],
                      [0.19677285318559556, 0.32105263157894726],
                      [0.22491381963681134, 0.4017543859649121],
                      [0.249535241612804, 0.47017543859649114],
                      [0.26976300400123115, 0.5298245614035086],
                      [0.30228224068944287, 0.6017543859649122],
                      [0.335672514619883, 0.6666666666666665],
                      [0.35411819021237306, 0.694736842105263],
                      [0.3734333641120345, 0.714035087719298],
                      [0.3892351492767005, 0.7280701754385963],
                      [0.42258618036318873, 0.7482456140350875],
                      [0.4585687903970452, 0.7684210526315788],
                      [0.5024430594028931, 0.7850877192982454],
                      [0.5550907971683595, 0.8035087719298244],
                      [0.5998414896891351, 0.819298245614035],
                      [0.6428408741151124, 0.83859649122807],
                      [0.6770675592489996, 0.857017543859649],
                      [0.705153893505694, 0.8754385964912279],
                      [0.7393844259772238, 0.8982456140350875],
                      [0.7929309018159434, 0.9412280701754384],
                      [0.8183902739304402, 0.9649122807017542],
                      [0.8333240997229916, 0.9894736842105262]])

van_winden = np.array([[0.05554680389273958, 0.0024154589371980784],
                       [0.08206434222502279, 0.024154589371980784],
                       [0.11337195733856098, 0.0628019323671496],
                       [0.13981364792643936, 0.11594202898550732],
                       [0.16141275175616698, 0.17391304347826086],
                       [0.1805730588811874, 0.24154589371980684],
                       [0.19735291372027347, 0.29468599033816434],
                       [0.22371875656374707, 0.37922705314009675],
                       [0.2561115778664612, 0.4685990338164252],
                       [0.28133970454386326, 0.5241545893719808],
                       [0.31380253914910494, 0.5845410628019324],
                       [0.34508681649513406, 0.6328502415458939],
                       [0.3763827627249178, 0.676328502415459],
                       [0.4112960629186211, 0.7222222222222223],
                       [0.44983838595999903, 0.7657004830917875],
                       [0.48235956498401344, 0.8019323671497586],
                       [0.5172962029452262, 0.8381642512077296],
                       [0.5510367803215944, 0.8695652173913044],
                       [0.5727234007794814, 0.8913043478260871],
                       [0.6040951947536698, 0.9033816425120774],
                       [0.6620312025951597, 0.9178743961352659],
                       [0.7211661882424327, 0.9359903381642514],
                       [0.7754644215734323, 0.9565217391304349],
                       [0.791144484118649, 0.9649758454106282],
                       [0.8019907115685314, 0.9746376811594204],
                       [0.8079972694812014, 0.9879227053140098]])

fuentes = np.array([[0.08215767634854773, 0.011550076617138028],
                    [0.10373443983402489, 0.028129680962793224],
                    [0.12199170124481327, 0.05052116871265988],
                    [0.14439834024896267, 0.08535734577572696],
                    [0.16182572614107882, 0.11355865084967542],
                    [0.1767634854771784, 0.15504003030250846],
                    [0.19336099585062236, 0.19154077925655522],
                    [0.20663900414937758, 0.2263845319467639],
                    [0.22406639004149378, 0.27616260050618957],
                    [0.23734439834024895, 0.3126661042337424],
                    [0.2580912863070539, 0.3690804221690397],
                    [0.27800829875518673, 0.4205161756856802],
                    [0.3004149377593361, 0.47194986312219134],
                    [0.32033195020746885, 0.511767359377421],
                    [0.35020746887966814, 0.5681741016855769],
                    [0.38008298755186737, 0.6113028356949776],
                    [0.4074688796680499, 0.6519440092284912],
                    [0.4464730290456433, 0.7041937983161446],
                    [0.48464730290456437, 0.7506351474664692],
                    [0.520331950207469, 0.7871200564728568],
                    [0.5593360995850623, 0.8252619617430828],
                    [0.5775933609958507, 0.8418443208622439],
                    [0.5925311203319502, 0.8509605550868613],
                    [0.6058091286307054, 0.8550989135861984],
                    [0.6547717842323653, 0.8724856665691016],
                    [0.7195020746887967, 0.8923489609338681],
                    [0.7692946058091287, 0.9080752741860504],
                    [0.8174273858921163, 0.9271224668996745],
                    [0.8522821576763485, 0.9436910521513058],
                    [0.8697095435684649, 0.9569545978891547],
                    [0.8821576763485478, 0.9693924002685903],
                    [0.8871369294605809, 0.9793467743323977],
                    [0.8879668049792531, 0.9926240939377764]])

plt.figure()
plt.plot(van_winden[:, 0], van_winden[:, 1])
plt.plot(fuentes[:, 0], fuentes[:, 1])
plt.plot(mencinger[:, 0], mencinger[:, 1])
plt.legend([r"N = 140x140", "Fuentes", "Mencinger"])
plt.xlabel(r'$x$')
plt.ylabel(r'$y$')
plt.xlim(0, 1)
plt.ylim(0, 1)
plt.title(f'Octadecane \n Position of melting front, Fo=0.1')
plt.savefig(path_name + f"melting_front" + "_comparison.png")
